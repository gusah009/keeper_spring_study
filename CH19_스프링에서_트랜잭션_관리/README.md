# Chaper 19 스프링에서 트랜잭션 관리

## 트랜잭션이란?

- 비즈니스에서 쪼개질 수 없는 하나의 단위 작업
  -ACID 원칙
  - `원자성`
    #### 하나의 트랜잭션은 모두 하나의 단위로 처리되어야 한다
    #### 어떤 작업이 잘못되는 경우 모든 것은 다시 원점으로 되돌아가야 한다
    <br/>
  - `일관성`
    #### 트랜잭션이 성공하면 DB의 모든 데이터는 일관성을 유지해야 한다
    #### 트랜잭션으로 처리한 데이터와 일반 데이터 사이에는 전혀 차이가 없어야 한다
    <br/>
  - `격리`
    #### 트랜잭션으로 처리되는 중간에 외부에서의 간섭은 없어야 한다
    <br/>
  - `영속성`
    #### 트랜잭션이 성공적으로 처리되면, 그 경과는 영속적으로 보관되어야 한다

<br/>

## 데이터베이스 설계

### `정규화`

- 데이터베이스의 저장 구조를 효율적으로 관리하기 위해 하는 작업
- 칼럼으로 처리되지 않는 데이터

  - 시간이 흐르면 변경되는 데이터
  - 계산이 가능한 데이터
  - 누구에게나 정해진 값을 사용하는 데이터

- 트랜잭션 처리 대상은 줄어드나 쿼리로 처리해야하는 양이 늘어난다
- 계산 결과를 미리 보관하여 성능을 올리는 반정규화 작업을 하기도 한다

## `@Transactional`

- 트랜잭션을 처리하기 위해서 제공되는 어노테이션
- 경우에 따라서 속성들을 조정해서 사용해야한다
  - `전파 속성`
  - `격리 레벨`
  - `Read-only 속성` : true인 경우 insert, update, delete 실행 시 예외 발생
  - `Rollback-for-예외` : 특정 예외가 발생 시 강제로 Rollback
  - `No-rollback-for-에외` : 특정 예외의 발생 시에는 Rollback 처리되지 않음
- 어노테이션의 우선순위
  #### 메서드의 `@Transactional` > 클래스의 `@Transactional` > 인터페이스의 `@Transactional`
